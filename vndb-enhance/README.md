# VNDB 增强脚本

Tampermonkey 油猴脚本，为 [VNDB](https://vndb.org/) 添加悬浮快捷按钮，支持通过 API 快速管理愿望单、黑名单，以及当前页批量拉黑。

## 功能

### 作品详情页 (`/v{id}`)
- **愿望单** — 一键加入/移出愿望单
- **黑名单** — 一键加入/移出黑名单
- 按钮高亮显示当前标签状态，操作后自动刷新页面

### 作品列表页 (`/v`)
- **批量拉黑** — 将当前分页所有可见作品加入黑名单（自动跳过已在黑名单或愿望单中的作品）
- **停止** — 中断正在执行的批量任务
- 支持作品链接在新标签页打开（可配置是否停留在当前页）

### 通用
- **设置** — 配置 API Token、并发数、请求间隔、重试次数等参数
- **返回顶部** — 平滑滚动到页面顶部
- 多标签页状态同步：在详情页操作后，列表页自动感知并刷新

## 安装

1. 安装 [Tampermonkey](https://www.tampermonkey.net/) 浏览器扩展
2. 新建脚本，将 `vndb.txt` 的内容粘贴进去并保存
3. 打开 VNDB 任意作品页面，右下角出现悬浮按钮即安装成功

## 配置

首次使用需要设置 API Token：

1. 登录 VNDB，前往 [API Token 管理页](https://vndb.org/u/tokens) 创建一个 Token
2. 点击脚本右下角的「设置」按钮，填入 Token 并保存

### 可调参数

| 参数 | 默认值 | 说明 |
|------|--------|------|
| 并发数 | 1 | 批量请求的并发数（1-5） |
| 请求间隔 | 500ms | 每次请求之间的等待时间（100-10000ms） |
| 重试次数 | 2 | 请求失败后的重试次数（0-5） |
| 自动刷新 | 开启 | 批量完成后自动刷新页面 |
| 新标签页打开 | 开启 | 列表页中点击作品在新标签页打开 |
| 停留当前页 | 开启 | 新标签页打开后焦点留在当前页 |

Token 输入框中填写 `!clear` 可清除已保存的 Token。
